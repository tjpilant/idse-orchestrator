# Feedback

## External / Internal Feedback
- Internal feedback (2026-02-03 to 2026-02-04): Notion MCP integration and sync troubleshooting while wiring the IDSE Orchestrator to Notion as Artifact Core storage. Feedback was generated by hands-on testing of CLI sync, MCP tool schemas, and Notion database configuration.

## Impacted Artifacts
- Intent: No changes required.
- Context: Updated understanding of MCP boundaries vs DesignStore responsibilities.
- Spec: Clarified storage backend requirements and Notion schema expectations.
- Plan / Test Plan: Updated operational steps for Notion sync setup/validation.
- Tasks / Implementation: Implemented Notion MCP backend, tooling, and debug flow.

## Risks / Issues Raised
- Notion MCP tool schemas are strict and differ by tool name; incorrect payloads silently fail or drop data.
- `notion-query-database-view` requires `view_url` in `view://<dashed-uuid>` format; HTTPS URLs were rejected.
- Notion select values are case-sensitive; stage values must match configured options.
- Without debug instrumentation, failures can appear as "success" while creating pages in unintended databases or with missing content.

## Actions / Follow-ups
- Confirm Notion database select options remain aligned with stage normalization (Owner: IDSE Orchestrator, Status: ongoing).
- Maintain a known-good Notion schema template for IDSE Artifacts (Owner: IDSE Orchestrator, Status: ongoing).
- Add a lightweight checklist for MCP tool schema verification on new backends (Owner: IDSE Orchestrator, Status: planned).

## Decision Log
- Chosen backend behavior: use DesignStore derivatives with MCP tooling rather than giving agents MCP access.
- For Notion sync: use `notion-create-pages` + `notion-update-page` with schema-compliant payloads; avoid `data_source_id` unless explicitly required.
- For stage mapping: normalize to Notion select values (`Intent`, `Context`, `Specification`, `Plan`, `Tasks`, `Test Plan`, `Feedback`).

## Lessons Learned (Verbose)

1) **Notion MCP tool schemas are strict and vary by tool name.**  
   `notion-query-database-view` requires `view_url`, and the accepted format was `view://<dashed-uuid>`. HTTPS view URLs failed.

2) **Database ID vs Data Source ID matters.**  
   For `notion-create-pages`, the correct parent is `parent: { type: "database_id" }` (not `data_source_id`) for this database.

3) **Select values are case-sensitive.**  
   Stage values must match the exact Notion select options. We normalized `intent → Intent`, `spec → Specification`, `implementation → Test Plan`.

4) **Content handling is tool-specific.**  
   `notion-create-pages` accepts a `content` string in Notion Markdown.  
   `notion-update-page` requires `data.command` with `replace_content`.

5) **Visibility depends on view filters.**  
   Pages can exist but be hidden by view filters. Always confirm via raw page URLs returned by MCP.

6) **Debug mode was essential.**  
   Logging payloads and results exposed misaligned schemas and wrong parent types quickly.
